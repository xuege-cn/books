{"./":{"url":"./","title":"Introduction","keywords":"","body":"Introduction Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-07-03 16:08:07 "},"knowledge/":{"url":"knowledge/","title":"çŸ¥è¯†æ˜Ÿçƒ","keywords":"","body":"çŸ¥è¯†æ˜ŸçƒğŸŒ è¿™é‡Œè®°å½•äº†å„ç§çŸ¥è¯†åˆ†ç±» Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-07-06 19:41:25 "},"knowledge/react/":{"url":"knowledge/react/","title":"React","keywords":"","body":"React Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-07-20 10:51:30 "},"knowledge/react/theory/":{"url":"knowledge/react/theory/","title":"ReactåŸç†","keywords":"","body":"ReactåŸç† Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-08-20 10:55:49 "},"knowledge/react/theory/1/1.html":{"url":"knowledge/react/theory/1/1.html","title":"Reactä¸­setStateåå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ","keywords":"","body":" è§£ç­” è°ƒç”¨setStateä¹‹åï¼Œä¼šç»å†ä¸€ä¸‹å‡ æ­¥ï¼š Reactä¼šå°†ä¼ å…¥çš„å‚æ•°å¯¹è±¡ä¸ç»„ä»¶å½“å‰çš„çŠ¶æ€åˆå¹¶ï¼Œç„¶åè§¦å‘æ‰€è°“çš„è°ƒå’Œè¿‡ç¨‹ ç»è¿‡è°ƒå’Œè¿‡ç¨‹ï¼ŒReactä¼šä»¥ç›¸å¯¹é«˜æ•ˆçš„æ–¹å¼æ ¹æ®æ–°çš„çŠ¶æ€æ„å»ºReactå…ƒç´ æ ‘å¹¶ä¸”ç€æ‰‹é‡æ–°æ¸²æŸ“æ•´ä¸ªUIç•Œé¢ åœ¨Reactå¾—åˆ°å…ƒç´ æ ‘ä¹‹åï¼ŒReactä¼šè‡ªåŠ¨è®¡ç®—å‡ºæ–°çš„æ ‘ä¸è€æ ‘çš„èŠ‚ç‚¹å·®å¼‚ï¼Œç„¶åæ ¹æ®å·®å¼‚å¯¹ç•Œé¢è¿›è¡Œæœ€å°åŒ–é‡æ¸²æŸ“ åœ¨å·®å¼‚è®¡ç®—ç®—æ³•ä¸­ï¼ŒReactèƒ½å¤Ÿç›¸å¯¹ç²¾ç¡®åœ°çŸ¥é“å“ªäº›ä½ç½®å‘ç”Ÿäº†æ”¹å˜ä»¥åŠåº”è¯¥å¦‚ä½•æ”¹å˜ï¼Œè¿™å°±ä¿è¯äº†æŒ‰éœ€æ›´æ–°ï¼Œè€Œä¸æ˜¯å…¨éƒ¨é‡æ–°æ¸²æŸ“ setStateä¸ºä»€ä¹ˆé»˜è®¤æ˜¯å¼‚æ­¥ å‡å¦‚æ‰€æœ‰setStateæ˜¯åŒæ­¥çš„ï¼Œæ„å‘³ç€æ²¡æ‰§è¡Œä¸€æ¬¡setSTateæ—¶ï¼Œéƒ½é‡æ–°vnode diff + domä¿®æ”¹ï¼Œè¿™å¯¹æ€§èƒ½æ¥è¯´æ˜¯æä¸ºä¸å¥½çš„ã€‚å¦‚æœæ˜¯å¼‚æ­¥ï¼Œåˆ™å¯ä»¥æŠŠä¸€ä¸ªåŒæ­¥ä»£ç ä¸­çš„å¤šä¸ªsetStateåˆå¹¶æˆä¸€æ¬¡ç»„ä»¶æ›´æ–°ã€‚ setStateä»€ä¹ˆæ—¶å€™æ˜¯åŒæ­¥ setTimeout åŸç”Ÿäº‹ä»¶ Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-07-20 11:17:01 "},"knowledge/react/theory/2/1.html":{"url":"knowledge/react/theory/2/1.html","title":"Reduxä¸­å¼‚æ­¥çš„è¯·æ±‚å¦‚ä½•å¤„ç†ï¼Ÿ","keywords":"","body":" è§£ç­” redux-thunk ç¬¬ä¸€æ­¥ï¼šé…ç½®redux-thunkï¼š import { createStore, applyMiddleware, compose } from 'redux' import thunk from 'redux-thunk' const enhancer = composeEnhancers(applymiddleware(thunk)) const store = createStore(reducer, enhancer) Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-07-20 15:56:26 "},"knowledge/react/theory/3/1.html":{"url":"knowledge/react/theory/3/1.html","title":"Reactç»„ä»¶ä¹‹é—´çš„é€šä¿¡æ–¹å¼","keywords":"","body":" è§£ç­” 1. çˆ¶ç»„ä»¶å‘è‡ªç»„ä»¶é€šä¿¡ - å±æ€§ä¼ é€’ 2. å­ç»„ä»¶å‘çˆ¶ç»„ä»¶é€šä¿¡ - å±æ€§æ–¹æ³•ä¼ é€’ 3. è·¨ç»„ä»¶é€šä¿¡ - å±æ€§ä¼ é€’ï¼Œä¼ é€’å±‚çº§è¾ƒæ·±å¢åŠ å¤æ‚åº¦ - ä½¿ç”¨context 4. æ²¡æœ‰åµŒå¥—å…³ç³»çš„ç»„ä»¶ - è‡ªå®šä¹‰äº‹ä»¶é€šä¿¡ï¼ˆå‘å¸ƒè®¢é˜…ï¼‰ - reduxç­‰å…¨å±€çŠ¶æ€ç®¡ç† - å…„å¼Ÿç»„ä»¶å¯ä»¥é€šä¿¡çˆ¶ç»„ä»¶é€šä¿¡ ä½¿ç”¨Contextè·¨ç»„ä»¶é€šä¿¡ const BatteryContext = createContext() { color => {} } Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-08-07 11:17:24 "},"knowledge/react/theory/4/1.html":{"url":"knowledge/react/theory/4/1.html","title":"React.createElementä¸»è¦åšäº†ä»€ä¹ˆï¼Ÿ","keywords":"","body":" ä¸ºä»€ä¹ˆä½¿ç”¨jsxçš„æ–‡ä»¶éƒ½éœ€è¦import Reactï¼Ÿ å› ä¸ºjsxä¼šè¢«è§£æä¸ºReact.createElementï¼ŒcreateElementæ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼š typeï¼šdiv configï¼šèŠ‚ç‚¹å±æ€§ï¼Œè¯¸å¦‚classNameï¼Œidï¼Œkeyï¼Œref children æ¥çœ‹ä¸€ä¸ªç®€å•çš„JSXè¢«babelä¹‹åï¼š this.ref = ref} key={1}> Hello World React.createElement('div', { className: '111', id: 'leo', ref: ref => this.ref = ref, key: 1 }, 'Hello World') å¦‚æœHello Worldæ˜¯å¤šä¸ªå¤æ‚èŠ‚ç‚¹å‘¢ this.ref = ref} key={1}> Hello World1 Hello World2 React.createElement('div', { className: '111', id: 'leo', ref: ref => this.ref = ref, key: 1 }, React.createElement('div', null, 'Hello World1'), React.createElement('div', null, 'Hello World2'), ) ä»è¿™é‡Œçœ‹å‡ºcreateElementçš„ç¬¬ä¸‰ä¸ªå‚æ•°childrenå…¶å®æ˜¯ä¸ªä¸å®šå‚æ•° createElementçš„ä¸»è¦æµç¨‹ ä»configä¸­è·å–ä¿ç•™å­—æ®µkeyï¼Œrefï¼Œselfï¼Œ source é™¤äº†ä¿ç•™å­—æ®µï¼Œå…¶ä»–å±æ€§ä»configèµ‹å€¼åˆ°propsã€‚tipsï¼špropsä¸ºä½•ç‰©ï¼Ÿconst props = {} å¤„ç†ä¸å®šå‚æ•°childrenï¼Œé€šè¿‡argumentsï¼Œèµ‹å€¼åˆ°props.children è·å–type.defaultPropsï¼Œå½“props[propName]ä¸ºundefinedæ—¶è¿›è¡Œèµ‹å€¼ type.defaultPropsæ˜¯ä»€ä¹ˆï¼Ÿ æ™®é€šèŠ‚ç‚¹æ˜¯æ²¡æœ‰defaultPropsçš„ï¼Œåªæœ‰ç»„ä»¶æ‰ä¼šæœ‰ï¼Œå¦‚ä¸‹ï¼š class App extends React.Component { render () { return Hello World } } App.defaultProps = { name: 'leo' } createElementåŠŸèƒ½ createElementå…¶å®å°±æ˜¯ä¸ªåˆ›å»ºvirtual Domçš„å‡½æ•°Virtual Domçš„ç»“æ„æ˜¯æ€æ ·çš„ï¼Ÿ { $$typeof: 0xeac7, type: 'div' æˆ–è€… Appï¼Œ key: '1', ref: ref => this.ref = ref, props: { className: '111', id: 'leo', name: 'leo', children: [ { $$typeof: 0xeac7, type: 'div', props: { children: ['Hello World'] } } ] } } Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-08-12 11:37:19 "},"knowledge/react/theory/5/1.html":{"url":"knowledge/react/theory/5/1.html","title":"React Component","keywords":"","body":" Reactä¸­PureComponentçš„å®ç°ï¼š // ä»¥ä¸‹åšçš„éƒ½æ˜¯ç»§æ‰¿åŠŸèƒ½ï¼Œè®© PureComponent ç»§æ‰¿è‡ª Component function ComponentDummy() {} ComponentDummy.prototype = Component.prototype; function PureComponent(props, context, updater) { this.props = props; this.context = context; this.refs = emptyObject; this.updater = updater || ReactNoopUpdateQueue; } const pureComponentPrototype = (PureComponent.prototype = new ComponentDummy()); pureComponentPrototype.constructor = PureComponent; Object.assign(pureComponentPrototype, Component.prototype); // é€šè¿‡è¿™ä¸ªå˜é‡åŒºåˆ«ä¸‹æ™®é€šçš„ Component pureComponentPrototype.isPureReactComponent = true; Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-08-12 14:00:33 "},"knowledge/react/theory/6/1.html":{"url":"knowledge/react/theory/6/1.html","title":"React Refçš„å®ç°åŸç†","keywords":"","body":" refçš„ä¸‰ç§ç”¨æ³• stringæ¨¡å¼çš„å·²è¢«åºŸå¼ƒ 1. å›è°ƒå‡½æ•°æ¨¡å¼ ref = { el => this.el = el } 2. createRef this.ref = React.createRef() ref = {this.ref} 3. forwardRef React.forwardRef((props, ref) => ( )) createRef function createRef () { const refObject = { current: null } return refObject } Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-08-12 14:08:59 "},"knowledge/react/theory/7/1.html":{"url":"knowledge/react/theory/7/1.html","title":"React Childrençš„å®ç°ç»†èŠ‚","keywords":"","body":" React.Children.mapçš„ä¸»è¦åŠŸèƒ½ ä¸‰ä¸ªå‚æ•°ï¼šchildrenï¼Œfuncï¼Œcontext ä¸»è¦åŠŸèƒ½ï¼šä½¿ç”¨ä¸Šä¸‹æ–‡contextå¯¹æ¯ä¸ªchildrenæ‰§è¡Œfunc è¿”å›ç»“æœçš„ç‰¹æ®Šå¤„ç†ï¼Œè¿”å›ç»“æœæ˜¯æ•°ç»„ï¼Œæ‹å¹³ å¦‚ä½•æ‹å¹³ï¼Ÿéå†æ¯ä¸€é¡¹æ‰§è¡ŒmapIntoWithKeyPrefixInterval ä¸¤ä¸ªé—®é¢˜ React.Children.mapçš„ç¬¬ä¸€ä¸ªå‚æ•°childrenå…è®¸å“ªå‡ ç§ç±»å‹ï¼Ÿ ä¸ºä»€ä¹ˆæ‰§è¡Œå®Œå›è°ƒçš„ç»“æœmappedChildï¼Œåˆ¤æ–­æ˜¯è¿˜è¦è¿›è¡ŒmapIntoWithKeyPrefixInternal è§£ç­” React.Children.map å°±æ˜¯ReacChildren.jsä¸­çš„mapChildrenå‡½æ•°ï¼Œä¸»è¦æµç¨‹å¦‚ä¸‹ï¼š mapChildrenå‡½æ•°ï¼š 1. å®šä¹‰resultï¼Œconst result = [] 2. mapIntoKeyPrefixInternal(children, result, null, func, context) 3. è¿”å›result mapIntoKeyPrefixInternalå‡½æ•°ï¼š 1. ç”Ÿæˆcontextï¼šgetPooledTraverseContext { result: [], keyprefix: '', func: func, context: null, count: 0 } 2. traverseAllChildrenImpl éå†childrenæ‰§è¡Œfunc 3. é‡Šæ”¾contextï¼šreleaseTraverseContext 3.1 æŠŠcontextä¸‹çš„å±æ€§éƒ½ç½®ä¸ºnullï¼Œcountç½®ä¸º0 3.2 æŠŠcontextæ”¾å…¥traverseContextPoolï¼Œä¸Šä¸‹æ–‡æ± sizeä¸º10 traverseAllChildrenImplå‡½æ•°ï¼š 1. childrenä¸ºstringï¼Œnumberæ—¶ï¼šè¡¨ç¤ºæ˜¯æ–‡æœ¬èŠ‚ç‚¹ 2. childrenä¸ºobjectç±»å‹ï¼Œchildren.$$typeofä¸ºREACT_ELEMENT_TYPEï¼ŒREACT_PORTAL_TYPEï¼Œè¯´æ˜æ˜¯å¯ä»¥æ¸²æŸ“çš„èŠ‚ç‚¹ 3. ä»¥ä¸Šå››ç§æƒ…å†µè¯æ˜childrenæ˜¯å¯æ¸²æŸ“çš„èŠ‚ç‚¹ï¼Œç›´æ¥æ‰§è¡ŒmapSingleChildIntoContext 4. childrenæ˜¯æ•°ç»„ï¼Œéå†childrenï¼Œå¯¹æ¯ä¸ªå…ƒç´ æ¥ä¸€æ¬¡traverseAllChildrenImpl 5. childrenæ˜¯å¯è¿­ä»£æ•°æ®ï¼Œè°ƒç”¨Symbol.iteratorï¼Œå¯¹æ¯ä¸ªå…ƒç´ æ¥ä¸€æ¬¡traverseAllChildrenImpl 6. childrenæ˜¯objectï¼Œæ”¾å¼ƒï¼Œéæ³•æ•°æ®è­¦å‘Š mapSingleChildIntoContextå‡½æ•°ï¼š 1. è·å–æ•°æ®ï¼šconst { result, keyPrefix, func, context } = bookKeeping 2. æ‰§è¡Œå›è°ƒï¼šlet mappedChild = func.call(context, child, bookKeeping.count++) 3. åˆ¤æ–­ç»“æœmappedChildæ˜¯æ•°ç»„ï¼Œä»mapIntoKeyPrefixInternalå¯¹æ¯ä¸€é¡¹å†èµ°ä¸€é 4. mappedChildä¸æ˜¯æ•°ç»„ï¼Œresult.push(mappedChild) ä¸ºä»€ä¹ˆåœ¨æ‰§è¡Œå®Œfuncå›è°ƒæ‹¿åˆ°mappedChildï¼Œè¿˜è¦å¯¹å…¶å¤„ç† å› ä¸ºReactéœ€è¦å¯¹å…¶è¿›è¡Œæ‹å¹³ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ç§åœºæ™¯ï¼š React.Children.map(this.props.children, child => [child, child]) è¿™ç§æƒ…å†µå¦‚æœChildrenæ˜¯[div1, div2]ï¼Œmapä¹‹åçš„ç»“æœä¸º[div1, div1, div2, div2] æ€§èƒ½ä¼˜åŒ–ç‚¹ const POOL_SIZE = 10; const traverseContextPool = []; function getPooledTraverseContext( mapResult, keyPrefix, mapFunction, mapContext, ) { if (traverseContextPool.length) { const traverseContext = traverseContextPool.pop(); traverseContext.result = mapResult; traverseContext.keyPrefix = keyPrefix; traverseContext.func = mapFunction; traverseContext.context = mapContext; traverseContext.count = 0; return traverseContext; } else { return { result: mapResult, keyPrefix: keyPrefix, func: mapFunction, context: mapContext, count: 0, }; } } function releaseTraverseContext(traverseContext) { traverseContext.result = null; traverseContext.keyPrefix = null; traverseContext.func = null; traverseContext.context = null; traverseContext.count = 0; if (traverseContextPool.length æä¸€ä¸ªtraverseContextPoolæ± å­ï¼Œå­˜å‚¨traverseContextå¯¹è±¡ï¼Œå°±ä¸ç”¨é¢‘ç¹åˆ›å»ºä¸€ä¸ªæœ‰å¾ˆå¤šå±æ€§çš„å¯¹è±¡ï¼Œå¾ˆæ¶ˆè€—æ€§èƒ½ Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-08-13 10:50:19 "},"knowledge/react/theory/8/1.html":{"url":"knowledge/react/theory/8/1.html","title":"React Fiber","keywords":"","body":" Fiberå‡ºç°çš„èƒŒæ™¯ Stack reconcilerçš„å·¥ä½œæµç¨‹å¾ˆåƒå‡½æ•°çš„è°ƒç”¨è¿‡ç¨‹ã€‚ çˆ¶ç»„ä»¶é‡Œè°ƒç”¨å­ç»„ä»¶ï¼Œå¯ä»¥ç±»æ¯”ä¸ºå‡½æ•°çš„å‡ºé€’å½’ å¯¹äºç‰¹åˆ«åºå¤§çš„vDOMæ ‘æ¥è¯´ï¼Œreconcilerè¿‡ç¨‹ä¼šå¾ˆé•¿ï¼Œè¶…è¿‡16ms reconcileræœŸé—´ï¼Œä¸»çº¿ç¨‹æ˜¯è¢«jså ç”¨çš„ï¼Œå› ä¸ºä»»ä½•äº¤äº’ï¼Œå¸ƒå±€ï¼Œæ¸²æŸ“éƒ½ä¼šåœæ­¢ï¼Œç»™ç”¨æˆ·å¡äº†çš„æ„Ÿè§‰ Reactåœ¨è¿›è¡Œç»„ä»¶æ¸²æŸ“æ—¶ï¼Œä»setStateåˆ°æ¸²æŸ“å®Œæˆæ•´ä¸ªè¿‡ç¨‹æ˜¯åŒæ­¥çš„ å¦‚æœæ¸²æŸ“çš„ç»„ä»¶æ¯”è¾ƒå¤§ï¼Œjsæ‰§è¡Œä¼šå æ®ä¸»çº¿ç¨‹äº‹ä»¶æ¯”è¾ƒé•¿ï¼Œå¯¼è‡´reactåœ¨åŠ¨ç”»ï¼Œæ‰‹åŠ¿ç­‰åº”ç”¨ä¸­æ•ˆæœæ¯”è¾ƒå·® Fiberå®ç°åŸç† å®ç°è‡ªå·±çš„ç»„ä»¶è°ƒç”¨æ ˆï¼Œä»¥é“¾è¡¨çš„å½¢å¼éå†ç»„ä»¶æ ‘ï¼Œå¯ä»¥çµæ´»çš„æš‚åœï¼Œç»§ç»­å’Œä¸¢å¼ƒæ‰§è¡Œçš„ä»»åŠ¡ã€‚ Fiberå…¶å®æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼š const fiber = { stateNode, child, sibling, return, } Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-08-13 17:38:44 "},"knowledge/react/theory/9/1.html":{"url":"knowledge/react/theory/9/1.html","title":"Reactå¦‚ä½•è‡ªå®šä¹‰å®ç°requestIdleCallback","keywords":"","body":" ä¸ºä»€ä¹ˆReactæ”¾å¼ƒä½¿ç”¨åŸç”ŸrequestIdleCallback? äº†è§£å‡ ä¸ªåç§°ï¼šFPSï¼šframe per secondï¼Œæ¯ç§’çš„å¸§æ•° å¸§çš„å‡ ä¸ªé—®é¢˜ setTimeout(callback) å’Œ setInterval(callback) å®ç°åŸç† reactä½¿ç”¨requestAnimationFrame + MessageChannel å®ç°requestIdleCallbackçš„polyfillç‰ˆæœ¬ï¼š let frameDeadline let activeFrameTime = 16 let channel = new MessageChannel() let port = channel.port2 channel.port1.onmessage = () => { const currentTime = performance.now() console.log('å½“å‰æ—¶é—´:', currentTime) console.log('å½“å‰å¸§å‰©ä½™æ—¶é—´:', frameDeadline - currentTime) } const startTime = performance.now() const requestAnimationFrameCircle = () => { requestAnimationFrame(timestamp => { frameDeadline = timestamp + activeFrameTime port.postMessage(undefined) if (performance.now() - startTime Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-08-31 20:17:06 "},"knowledge/react/redux/":{"url":"knowledge/react/redux/","title":"Reduxå®ç°","keywords":"","body":"ReduxåŸç† Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-08-20 10:56:55 "},"knowledge/react/redux/0/0.html":{"url":"knowledge/react/redux/0/0.html","title":"Reduxçš„è®¾è®¡æ€è·¯åŠå®ç°","keywords":"","body":"Reduxçš„è®¾è®¡æ€è·¯åŠå®ç° Reduxçš„å®šä½ Predictable state container for JavaScript apps jsåº”ç”¨çš„å¯é¢„æµ‹çŠ¶æ€å®¹å™¨ èƒŒæ™¯ å¯¼è‡´æ•°æ®ç»“æ„æ›´æ–°çš„æ¥æºå¾ˆä¸°å¯Œï¼šäº‹ä»¶ï¼Œajaxï¼Œè·¯ç”±ç­‰ æ¯ä¸ªæ¥æºæä¾›çš„æ•°æ®ç»“æ„ä¸ç»Ÿä¸€ actionæ˜¯ä»€ä¹ˆï¼Ÿ actionçš„åŠŸèƒ½ æŠŠæ•°æ®ä»åº”ç”¨ä¼ åˆ°storeçš„æœ‰æ•ˆè½½è·ï¼Œæ˜¯storeæ•°æ®çš„å”¯ä¸€æ¥æº actionè§„èŒƒ çº¦å®šactionå†…å¿…é¡»æœ‰typeå­—æ®µè¡¨ç¤ºå°†è¦æ‰§è¡Œçš„åŠ¨ä½œ å°½é‡å‡å°‘åœ¨actionä¸­ä¼ é€’æ•°æ® å¤§åº”ç”¨ä¸­actionå¾€å¾€æ‹†åˆ†åˆ°å•ç‹¬çš„æ–‡ä»¶ä¸­ Reduxçš„ç®€å•å®ç° function createStore (reducer, initState) { let state = initState let listeners = [] function subscribe (listener) { listeners.push(listener) return unsubscribe () { const index = listeners.indexOf(listener) listeners.splice(index, 1) } } function dispatch (action) { state = reducer(state,action) for (let listener of listeners) { listener(state) } } function getState () { return state } return { dispatch, subscribe, getState } } ä¸ºä»€ä¹ˆä¼šæœ‰reducer actionåªæ˜¯æè¿°äº†æœ‰äº‹æƒ…å‘ç”Ÿï¼Œå¹¶æ²¡æœ‰æè¿°åº”ç”¨å¦‚ä½•æ›´æ–°stateï¼Œreduceræ‰æ˜¯çœŸæ­£æ”¹å˜stateçš„åœ°æ–¹ reducerå†…å®¹å¤šäº†ä¹‹åéœ€è¦è¿›è¡Œæ‹†åˆ†æˆå¤šä¸ªæ–‡ä»¶ï¼Œç„¶åæœ‰éœ€è¦combineReducersæˆä¸€ä¸ª combineReducersçš„åŸç†æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ å¤šä¸ªreducerå’ŒinitStateæœ‰ä¸ªè¦æ±‚ï¼š { counter: function (state, action) {}, info: function (state, action) {} } { counter: {}, info: {} } combineReducersçš„å®ç°ï¼š function combineReducers (reducers) { const keys = Object.keys(reducers) return combine (state, action) { for (ley key of keys) { const reducer = reducers[key] const prevState = state[key] const nextState = reducer(prevState, action) state[key] = nextState } return state } } ä¸­é—´ä»¶æ‰©å±•dispatch ä¸­é—´ä»¶çš„æœ€åŸå§‹å®ç°æ–¹æ³•ï¼š let next = store.dispatch function log () { const prevState = store.getState() next() const nextState = store.getState() } è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªåœºæ™¯ï¼š å¤šä¸ªä¸­é—´ä»¶æ—¶ï¼šnextéœ€è¦æå–åˆ°å‚æ•° ä¸­é—´ä»¶ä½œä¸ºå•ç‹¬æ–‡ä»¶å­˜å‚¨ï¼Œstoreéœ€è¦æå–åˆ°å‚æ•° const log = store => next => action => { const prevState = store.getState() next(action) const nextState = store.getState() } Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-08-21 16:12:53 "},"knowledge/react/redux/3/1.html":{"url":"knowledge/react/redux/3/1.html","title":"Reduxçš„è®¾è®¡æ€è·¯","keywords":"","body":"ä¸ºä»€ä¹ˆè¦æœ‰actionï¼Ÿ æ¯ä¸ªwebåº”ç”¨éƒ½è‡³å°‘å¯¹åº”ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œè€Œå¯¼è‡´è¿™ä¸ªæ•°æ®ç»“æ„çŠ¶æ€æ›´æ–°çš„æ¥æºå¾ˆä¸°å¯Œï¼›å…‰æ˜¯ç”¨æˆ·å¯¹è§†å›¾å±‚çš„æ“ä½œï¼ˆdomäº‹ä»¶ï¼‰å°±æœ‰å‡ åç§ï¼Œæ­¤å¤–è¿˜æœ‰ajaxè·å–æ•°æ®ï¼Œè·¯ç”±/hashçŠ¶æ€å˜åŒ–çš„è®°å½•å’Œè·Ÿè¸ªç­‰ã€‚ ç—›ç‚¹ï¼š å¯¼è‡´æ•°æ®æ›´æ–°çš„æ¥æºå¾ˆä¸°å¯Œã€‚ æ¯ä¸ªæ¥æºæä¾›çš„æ•°æ®ç»“æ„å¹¶ä¸ç»Ÿä¸€ã€‚ æ¥æºèƒå–å·¥ä½œï¼šactioné¢„å¤„ç†å‡½æ•°åœ¨webåº”ç”¨ä¸­æ‰€æœ‰çš„æ•°æ®ä¸çŠ¶æ€çš„å˜åŒ–ï¼Œå‡ ä¹éƒ½æ¥è‡ªäº‹ä»¶ã€‚actionè·Ÿeventå¹¶ä¸ç­‰åŒï¼Œåªåœ¨e.keyCodeç­‰äºå›è½¦é”®æˆ–è€…å–æ¶ˆé”®æ—¶ï¼Œæ‰è§¦å‘ä¸€ç±»actionã€‚actionå‡½æ•°å¿…é¡»è¿”å›ä¸€ä¸ªå¸¦typeå±æ€§çš„plain objectã€‚ ä¸ºä»€ä¹ˆè¦æœ‰reducerï¼Ÿ actionæœªå¿…äº§ç”Ÿäº†å¯ä»¥ç›´æ¥åˆå¹¶åˆ°å…¨å±€å¯¹è±¡çš„æ•°æ®ä¸ç»“æ„ï¼Œç”šè‡³å¯èƒ½åªæ˜¯æä¾›äº†çº¿ç´¢ã€‚reducerï¼šæ•°æ®å†å¤„ç†å‡½æ•° Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-08-20 17:35:48 "},"knowledge/react/redux/1/1.html":{"url":"knowledge/react/redux/1/1.html","title":"Reduxä¸­storeçš„æ•°æ®ç»“æ„æ˜¯å¦‚ä½•å­˜å‚¨çš„ï¼Ÿ","keywords":"","body":" è§£ç­” stateæ˜¯å¦‚ä½•å­˜å‚¨çš„ï¼Ÿ createStoreå‡½æ•°å†…éƒ¨æœ‰ä¸ªcurrentStateå±æ€§ å¤–éƒ¨è®¿é—®ä¸åˆ°stateï¼Œè·å–é€šè¿‡store.getStateæ–¹æ³•è·å–stateï¼Œå…¶å®å°±æ˜¯åˆ©ç”¨äº†å¿…æŠ¥ stateçš„æ•°æ®ç»“æ„æ˜¯æ€æ ·çš„ï¼Ÿ åˆå§‹å€¼æ˜¯preloadStateï¼ŒpreloadStateçš„ç»“æ„å³ä¸ºstateç»“æ„ stateå¦‚æœæ”¹å˜ï¼Ÿ é€šè¿‡dispatchå‡½æ•°æ”¹å˜stateï¼Œæ¥æ”¶ä¸€ä¸ªaction: { type: 'add' } dispatchçš„åŸç† æ ¸å¿ƒå°±æ˜¯è¿™ä¸€æ®µï¼š currentState = currentReducer(currentState, action) é€šè¿‡currentReducerè·å–æ–°çš„state Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-08-20 11:45:48 "},"knowledge/react/redux/2/1.html":{"url":"knowledge/react/redux/2/1.html","title":"stateæ”¹å˜ä¹‹åï¼Œå¦‚ä½•é€šçŸ¥ï¼Ÿ","keywords":"","body":" è§£ç­” ç”¨æ³•ï¼š store.subscribe(() => { console.log('subscribe store') }) function subscribe () { nextListeners.push(listener) return function unsubscribe() { const index = nextListeners.indexOf(listener) nextListeners.splice(index, 1) } } Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-08-20 15:26:02 "},"knowledge/browser/":{"url":"knowledge/browser/","title":"Browser","keywords":"","body":"browser Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-07-22 14:18:37 "},"knowledge/browser/1/1.html":{"url":"knowledge/browser/1/1.html","title":"æ¸²æŸ“æ€§èƒ½","keywords":"","body":"æ¸²æŸ“æ€§èƒ½ é—®é¢˜ï¼š å¸§çš„æ¦‚å¿µ ç°åœ¨å¹¿æ³›ä½¿ç”¨çš„å±å¹•éƒ½æœ‰å›ºå®šçš„åˆ·æ–°ç‡ï¼ˆæœ€æ–°çš„ä¸€èˆ¬åœ¨60Hzï¼‰ï¼Œåœ¨ä¸¤æ¬¡ç¡¬ä»¶åˆ·æ–°ä¹‹é—´æµè§ˆå™¨è¿›è¡Œä¸¤æ¬¡é‡ç»˜æ˜¯æ²¡æœ‰æ„ä¹‰çš„åªä¼šæ¶ˆè€—æ€§èƒ½ æ¸²æŸ“å¸§ æŒ‡æµè§ˆå™¨ä¸€æ¬¡å®Œæ•´ç»˜åˆ¶è¿‡ç¨‹ å¸§ä¹‹é—´çš„æ—¶é—´é—´éš”æ˜¯DOMè§†å›¾æ›´æ–°çš„æœ€å°é—´éš” æ˜¯å¦æ„å‘³ç€DOMè§†å›¾æ›´æ–°æœ€å°æ—¶é—´ä¸º16ms ä¸»æµæµè§ˆå™¨å±å¹•åˆ·æ–°ç‡ä¸º60Hzï¼Œæ¸²æŸ“ä¸€å¸§çš„æ—¶é—´å¿…é¡»æ§åˆ¶åœ¨16msä¹‹å†…æ‰èƒ½ä¿è¯ä¸æ‰å¸§ æµè§ˆå™¨æ‰§è¡Œä¸€æ¬¡æ¸²æŸ“ä¸»è¦æ˜¯åšå‡ ä»¶äº‹ï¼Œå¦‚ä¸‹å›¾ æµè§ˆå™¨æ¯å¸§å¤„ç†æµç¨‹ï¼š input event handlers: å¤„ç†äº‹ä»¶å›è°ƒï¼Œæ¯”å¦‚scrollç­‰ requestAnimationFrame: å›è°ƒå‡½æ•°åœ¨ä¸‹ä¸€æ¬¡é‡ç»˜ä¹‹å‰æ‰§è¡Œ Parse HTML: ç”ŸæˆDOM tree Recalc Styles: çº§è”åœ°ç”Ÿæˆæ¯ä¸ªèŠ‚ç‚¹åœ°ç”Ÿæ•ˆæ ·å¼ Layout: æ•´åˆDOM treeå’Œstyle treeï¼Œç”Ÿæˆlayout tree Update Layer tree: è§£æå±‚å ä¸Šä¸‹æ–‡ï¼Œç”Ÿæˆlayer tree Paint: å„å±‚åˆ†åˆ«è¿›è¡Œç»˜åˆ¶ Composite: åˆæˆå„å±‚çš„æ¸²æŸ“ç»“æœ æ‰å¸§çš„æ¦‚å¿µ Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-07-22 11:57:42 "},"knowledge/browser/2/1.html":{"url":"knowledge/browser/2/1.html","title":"cookie","keywords":"","body":"cookie ä¸ºä»€ä¹ˆéœ€è¦cookie httpæ˜¯æ— çŠ¶æ€çš„ï¼Œæ¯æ¬¡ç”¨æˆ·è¯·æ±‚åˆ°è¾¾æœåŠ¡ç«¯ï¼ŒæœåŠ¡å™¨éƒ½ä¸çŸ¥é“ç”¨æˆ·æ˜¯è°ï¼Œæ˜¯å¦ç™»é™†è¿‡ cookieçš„æ„æˆ author=leo; é”®å€¼å¯¹ expires=Fri, 31 Dec 9999 23:59:59 GMT; å¤±æ•ˆæ—¶é—´ path=/; æ§åˆ¶ç›¸å¯¹è·¯å¾„ä¸‹å¯ä»¥è®¿é—® domain=.foo.com\"; æ§åˆ¶ç›¸å¯¹åŸŸåå¯ä»¥è®¿é—® httpOnly=true; æ˜¯å¦åªç”¨äºæœåŠ¡ç«¯ä¼ è¾“ï¼Œdocument.cookieä¸å¯å– Secure=true; è¡¨ç¤ºåªä¼šå‘é€ç»™httpsçš„ä¸»æœº SameSite=true; é™åˆ¶è·¨ç«™æºå¸¦cookie cookieçš„å®‰å…¨éšæ‚£ cookieæ˜¯å¯ä»¥è¢«ç¯¡æ”¹çš„ï¼Œcurlï¼Œnodejsç­‰éƒ½å¯ä»¥å‘èµ·httpè¯·æ±‚ï¼Œå¯ä»¥è®¾ç½®ä»»ä½•å¤´å­—æ®µï¼Œå®¹æ˜“è¢«å…¶æ¬ºéª— cookieçš„å¼Šç«¯ æµè§ˆå™¨çš„æ¯æ¬¡è¯·æ±‚éƒ½ä¼šæºå¸¦cookieæ•°æ®ï¼Œä¼šåˆ°æ¥é¢å¤–çš„æ€§èƒ½å¼€é”€ Cookieæ˜æ–‡ä¼ è¾“ï¼Œå®‰å…¨æ€§æˆé—®é¢˜ Cookieå¤§å°é™åˆ¶åœ¨4KBå·¦å³ï¼Œå¤æ‚çš„å­˜å‚¨éœ€æ±‚ä¸å¤Ÿç”¨ Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-07-22 22:03:55 "},"knowledge/browser/0/1.html":{"url":"knowledge/browser/0/1.html","title":"DOMContentLoadedå…¨é¢è§£æ","keywords":"","body":" DOMContentLoaded åˆå§‹HTMLæ–‡æ¡£è¢«å®Œå…¨åŠ è½½å’Œè§£æå®Œæˆä¹‹åï¼ŒDOMContentLoadedäº‹ä»¶è¢«è§¦å‘ ä»€ä¹ˆæ—¶å€™ç®—æ˜¯æ–‡æ¡£åŠ è½½å®Œï¼Ÿ åŒæ­¥javascriptä¼šæš‚åœDOMçš„è§£æ document.addEventListener('DOMContentLoaded', function () { console.log('DOMContentLoaded:', (Date.now() - domStart)) }) const start = Date.now() while (true) { const end = Date.now() if (end - start > 5000) { break } } console.log('script loaded!') å¯ä»¥å‘ç°å½“æ—¶é—´æ˜¯5000æ—¶ï¼ŒDOMContentLoadedçš„æ—¶é—´ä¸º5048ï¼Œè€Œwhileçš„æ—¶é—´ä¸º1000æ—¶ï¼ŒDOMContentLoadedçš„æ—¶é—´ä¸º1048æ‰€ä»¥ï¼šåŒæ­¥çš„JSæ–‡æ¡£é˜»å¡äº†DOMçš„è§£æ async å’Œ deferå¯¹äºDOMContentLoadedçš„å½±å“ document.addEventListener('DOMContentLoaded', function () { console.log('DOMContentLoaded:', (Date.now() - domStart)) }) const start = Date.now() while (true) { const end = Date.now() if (end - start > 5000) { break } } console.log('script loaded!') å‡ºç°äº†ä¸¤ç§ä¸åŒæƒ…å†µï¼š async asyncæ˜¯å¼‚æ­¥åŠ è½½ï¼ŒåŠ è½½å®Œæˆä¾¿æ‰§è¡Œ document.addEventListener('DOMContentLoaded', ...)åœ¨å‰é¢ï¼ŒDOMContentLoaded é©¬ä¸Šæ‰§è¡Œ åœ¨å‰é¢ï¼Œå°±çœ‹jsçš„ä¸‹è½½é€Ÿåº¦äº†ï¼Œåœ¨æ‰§è¡ŒDOMContentLoadedä¹‹å‰ä¸‹è½½å®Œæˆï¼ŒDOMContentLoadedçš„æ—¶é—´å°±æ˜¯5048 defer è¯¥å±æ€§ç”¨æ¥é€šçŸ¥æµè§ˆå™¨è¯¥è„šæœ¬å°†åœ¨æ–‡æ¡£å®Œæˆè§£æåï¼Œè§¦å‘DOMContentLoadedäº‹ä»¶å‰æ‰§è¡Œ æ‰€ä»¥è¿™é‡ŒDOMContentLoadedæ—¶é—´æ˜¯5048 readyState readyStateçš„ä¸‰ç§çŠ¶æ€ï¼š loading interactive complete readyStateè·ŸDOMContentLoadedçš„å…³è” DOMContentLoadedäº‹ä»¶å¿…é¡»æ˜¯åœ¨document.readyStateä¸ºloadingæ—¶ç»‘å®šæ‰æœ‰æ•ˆ const script = document.createElement('script') script.src=\"./test.js\" document.body.appendChild(script) console.log('test.js load') document.addEventListener('DOMContentLoaded', function () { console.log('DOMContentLoaded') }) è¿™ä¸ªğŸŒ°å¯ä»¥çœ‹åˆ°ï¼šDOMContentLoadedäº‹ä»¶æœªè¢«æ‰§è¡Œ Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-08-28 18:06:20 "},"knowledge/browser/3/1.html":{"url":"knowledge/browser/3/1.html","title":"DOMContentLoadedå…¨é¢è§£æ","keywords":"","body":" DOMContentLoaded åˆå§‹HTMLæ–‡æ¡£è¢«å®Œå…¨åŠ è½½å’Œè§£æå®Œæˆä¹‹åï¼ŒDOMContentLoadedäº‹ä»¶è¢«è§¦å‘ ä»€ä¹ˆæ—¶å€™ç®—æ˜¯æ–‡æ¡£åŠ è½½å®Œï¼Ÿ åŒæ­¥javascriptä¼šæš‚åœDOMçš„è§£æ document.addEventListener('DOMContentLoaded', function () { console.log('DOMContentLoaded:', (Date.now() - domStart)) }) const start = Date.now() while (true) { const end = Date.now() if (end - start > 5000) { break } } console.log('script loaded!') å¯ä»¥å‘ç°å½“æ—¶é—´æ˜¯5000æ—¶ï¼ŒDOMContentLoadedçš„æ—¶é—´ä¸º5048ï¼Œè€Œwhileçš„æ—¶é—´ä¸º1000æ—¶ï¼ŒDOMContentLoadedçš„æ—¶é—´ä¸º1048æ‰€ä»¥ï¼šåŒæ­¥çš„JSæ–‡æ¡£é˜»å¡äº†DOMçš„è§£æ async å’Œ deferå¯¹äºDOMContentLoadedçš„å½±å“ document.addEventListener('DOMContentLoaded', function () { console.log('DOMContentLoaded:', (Date.now() - domStart)) }) const start = Date.now() while (true) { const end = Date.now() if (end - start > 5000) { break } } console.log('script loaded!') å‡ºç°äº†ä¸¤ç§ä¸åŒæƒ…å†µï¼š async asyncæ˜¯å¼‚æ­¥åŠ è½½ï¼ŒåŠ è½½å®Œæˆä¾¿æ‰§è¡Œ document.addEventListener('DOMContentLoaded', ...)åœ¨å‰é¢ï¼ŒDOMContentLoaded é©¬ä¸Šæ‰§è¡Œ åœ¨å‰é¢ï¼Œå°±çœ‹jsçš„ä¸‹è½½é€Ÿåº¦äº†ï¼Œåœ¨æ‰§è¡ŒDOMContentLoadedä¹‹å‰ä¸‹è½½å®Œæˆï¼ŒDOMContentLoadedçš„æ—¶é—´å°±æ˜¯5048 defer è¯¥å±æ€§ç”¨æ¥é€šçŸ¥æµè§ˆå™¨è¯¥è„šæœ¬å°†åœ¨æ–‡æ¡£å®Œæˆè§£æåï¼Œè§¦å‘DOMContentLoadedäº‹ä»¶å‰æ‰§è¡Œ æ‰€ä»¥è¿™é‡ŒDOMContentLoadedæ—¶é—´æ˜¯5048 readyState readyStateæ˜¯ä¸€ä¸ªåªè¯»å±æ€§readyStateçš„ä¸‰ç§çŠ¶æ€ï¼š loading interactive complete readyStateæ”¹å˜çš„äº‹ä»¶ï¼šdocument.onreadystatechange readyStateè·ŸDOMContentLoadedçš„å…³è” DOMContentLoadedäº‹ä»¶å¿…é¡»æ˜¯åœ¨document.readyStateä¸ºloadingæ—¶ç»‘å®šæ‰æœ‰æ•ˆ const script = document.createElement('script') script.src=\"./test.js\" document.body.appendChild(script) console.log('test.js load') document.addEventListener('DOMContentLoaded', function () { console.log('DOMContentLoaded') }) è¿™ä¸ªğŸŒ° å¯ä»¥çœ‹åˆ°ï¼šDOMContentLoadedäº‹ä»¶æœªè¢«æ‰§è¡Œ readyStateå’ŒDOMContentLoadedæ‰§è¡Œé¡ºåºï¼š readyState: loading â†“ readyState: interctive â†“ DOMContentLoadedäº‹ä»¶ â†“ readyState: complete â†“ loadäº‹ä»¶ jsä»£ç æ”¾åœ¨æ–‡æ¡£æœ€å æ­¤æ—¶jsæ˜¯ä¸éœ€è¦åƒä¸‹é¢è¿™æ ·å†™çš„ $(document).ready(function() { // å°‘å¹´çš„ä½ ï¼Œä»£ç å†™åœ¨è¿™é‡Œ... }); å…¶å®jsåœ¨æ–‡æ¡£æœ€åï¼Œæ–‡æ¡£å·²ç»è§£æå¥½äº†ï¼Œæ‰€ä»¥åªéœ€è¦åƒä¸‹é¢è¿™æ ·å†™å°±è¡Œäº†ï¼š (function() { // è¿™é‡Œä»£ç ... })(); ä¼˜ç‚¹æ˜¯ï¼šæ‰§è¡Œæ—¶æœºæ›´å¿« readyStateç°åœ¨è¿˜æœ‰å•¥é”¤å­ç”¨ï¼Ÿ åˆ¤æ–­æ—¶æœºä¸ºloadingï¼Œç»‘å®šDOMContentLoadedäº‹ä»¶ if (document.readyState != 'loading') { init(); } else { window.addEventListener(\"DOMContentLoaded\", function () { init(); }); } Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-08-31 16:47:34 "}}