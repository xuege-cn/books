{"./":{"url":"./","title":"Introduction","keywords":"","body":"Introduction Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-07-03 16:08:07 "},"interview/":{"url":"interview/","title":"æ¯æ—¥ä¸€é¢˜","keywords":"","body":"æ¯æ—¥ä¸€é¢˜ ä¸€å¤©ä¸€é¢˜ç»ƒä¹  Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-07-06 19:33:17 "},"interview/vue/":{"url":"interview/vue/","title":"vue","keywords":"","body":"è¿™é‡Œæ˜¯vueä¸“é¢˜ Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-07-03 16:11:09 "},"interview/vue/1/1.html":{"url":"interview/vue/1/1.html","title":"çˆ¶ç»„ä»¶ç›‘å¬å­ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ","keywords":"","body":" è§£æ³•1: @hook @hook:æ­é…ä»»æ„é’©å­å‡½æ•°ï¼Œä¼šåœ¨å­ç»„ä»¶è§¦å‘ç›¸åº”ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°æ—¶å›è°ƒçˆ¶ç»„ä»¶è¿™ä¸ªå‡½æ•° è§£æ³•2: $emit è¿™ç§æ–¹å¼æ¯”è¾ƒè ¢ï¼Œè€Œä¸”æ˜¯éœ€è¦åŠ³åŠ¨åŠ›å †ç§¯çš„ mounted () { this.$emit('mounted') } Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-07-03 16:36:45 "},"interview/vue/2/1.html":{"url":"interview/vue/2/1.html","title":"$setè§£å†³æ–°å¢å±æ€§ä¸èƒ½ç›¸åº”çš„é—®é¢˜","keywords":"","body":" è§£ç­”ï¼š æ˜¯å› ä¸ºVueåœ¨å®ä¾‹åŒ–çš„è¿‡ç¨‹ä¸­å°±éœ€è¦å¯¹dataä¸­çš„æ•°æ®ä½¿ç”¨definePropertyæ–¹æ³•æ¥å®šä¹‰å­˜å–å™¨å®ç°çš„å“åº”å¼ã€‚è€Œç›´æ¥æ–°å¢å±æ€§å› ä¸ºä»æ˜¯å€¼å±æ€§ï¼Œæ‰€ä»¥æ˜¯ä¸èƒ½å®ç°å“åº”å¼çš„ æºç å®ç° const isValidArrayIndex = index => { return index > 0 && Math.floor(index) === index && isFinite(index) } exprt function set (target, key, val) { if (Array.isArray(target) && isValidArrayIndex(key)) { target.length = Math.max(target.length, key) target.splice(key, 1, val) return val } if (key in target && !(key in target.prototype)) { target[key] = val return val } const __ob__ = target.__ob__ if (!__ob__) { target[key] = val return val } else { defineReactive(__ob__.value, key, val) __ob__.dep.notify() return val } } setåˆ†ä¸ºå››æ­¥éª¤ï¼š åˆ¤æ–­æ˜¯å¦ä¸ºæ•°ç»„ï¼Œä»¥åŠç´¢å¼•æ˜¯å¦åˆæ³• Array.isArrayåˆ¤æ–­targetæ˜¯å¦ä¸ºæ•°ç»„ ç´¢å¼•æ˜¯å¦åˆæ³•ï¼šindex > 0 && Math.floor(index) === index && isFinite(index) æ•°ç»„å¯èƒ½ä¸å¤Ÿé•¿ï¼Œå…ˆæŠŠæ•°ç»„æ‰©å……ä¸‹ï¼štarget.length = Math.max(target.length, key) é€šè¿‡spliceå¾€æ•°ç»„ä¸­æ·»åŠ ï¼štarget.splice(key, 1, val) åˆ¤æ–­targetå¯¹è±¡ä¸‹æ˜¯å¦å·²ç»è¯¥å±æ€§key å­˜åœ¨çš„è¯å°±æ˜¯ä¿®æ”¹æ“ä½œï¼Œç›´æ¥target[key] = valï¼Œé€šè¿‡setterå­˜å–å™¨è§¦å‘notify targetæ˜¯å¦å·²è¢«å“åº”å¼ å¦ï¼šä¸ç®¡å“åº”å¼ï¼Œtarget[key] = valå®Œäº‹ å·²è®¾ç½®å“åº”å¼ï¼ŒdefineReactive(ob.value, key, val), ob.dep.notify()è§¦å‘æ›´æ–° definePropertyçš„ç¼ºç‚¹ ä»è¿™ä¸ªé—®é¢˜å¯ä»¥çœ‹å‡ºï¼šdefinePropertyå®ç°å“åº”å¼ï¼Œéœ€è¦åœ¨vueå®ä¾‹åŒ–æ—¶å¯¹æ‰€æœ‰å±æ€§è¿›è¡Œé‡å®šä¹‰ï¼Œä¸ç„¶çš„è¯å°±ä¸èƒ½å®ç°å“åº”å¼æœ‰ç‚¹ç±»ä¼¼äº‹ä»¶ç»‘å®šæ—¶ï¼Œå¯¹å•ä¸ªèŠ‚ç‚¹ Proxyçš„ä½¿ç”¨ let obj = { a: 1, b: 2 } let obj1 = new Proxy(obj, { get (obj, prop) { console.log(`æ­£åœ¨è·å–å±æ€§ï¼š${prop}ï¼Œå€¼ä¸ºï¼š${obj[prop]}`) return obj[prop] } }) obj1.a obj1.b Proxyç±»ä¼¼äº‹ä»¶å§”æ‰˜ï¼ŒæŠŠå±æ€§è®¿é—®å§”æ‰˜åˆ°å¦ä¸€ä¸ªå¯¹è±¡ä¸Šï¼Œå¯æ˜¯ä¸å…·ä½“å…³å¿ƒæ˜¯ä»€ä¹ˆå±æ€§ï¼Œæ‰€ä»¥åœ¨Vueå®ä¾‹åŒ–é˜¶æ®µå‡å°‘äº†å¯¹dataä¸‹æ‰€æœ‰å±æ€§è¿›è¡ŒdefinePropertyå®šä¹‰å­˜å–å™¨ Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-07-06 19:21:01 "},"interview/vue/3/1.html":{"url":"interview/vue/3/1.html","title":"è‡ªå®šä¹‰æŒ‡ä»¤å®ç°å›¾ç‰‡æ‡’åŠ è½½","keywords":"","body":" å›¾ç‰‡æ‡’åŠ è½½çš„ä¸‰ç§å®ç°æ–¹å¼ scrolläº‹ä»¶ + getBoundingClientRect const imgs = document.getElementsByTagName('img') const body = document.body function imgLoad () { for (let img of imgs) { const clientRect = img.getBoundingClientRect() if (clientRect.bottom { timer = null func.apply(this, args) }, wait) } } } document.addEventListener('scroll', throttle(imgLoad, 0)) imgLoad() InsectionObserver const imgs = document.getElementsByTagName('img') const intersectionObserver = new IntersectionObserver(function(entries) { for (let entry of entries) { if (entry.intersectionRatio > 0) { const target = entry.target target.style.height = 'auto' target.src = target.getAttribute('data-src') intersectionObserver.unobserve(target) } } }) for (let img of imgs) { intersectionObserver.observe(img) } æµè§ˆå™¨åŸç”Ÿæ”¯æŒloading=\"lazy\" Vueè‡ªå®šä¹‰æŒ‡ä»¤ + å›¾ç‰‡æ‡’åŠ è½½ æ¨¡ç‰ˆï¼š const intersectionObserver = new IntersectionObserver(function(entries) { for (let entry of entries) { if (entry.intersectionRatio > 0) { const target = entry.target target.style.height = 'auto' target.src = target.getAttribute('data-src') intersectionObserver.unobserve(target) } } }) directives: { lazy: { inserted: function (el) { intersectionObserver.observe(el) } } } directiveçš„é’©å­å‡½æ•° bindï¼šæŒ‡ä»¤ç¬¬ä¸€æ¬¡ç»‘å®šåˆ°å…ƒç´ æ—¶è°ƒç”¨ insertedï¼šå…ƒç´ æ’å…¥çˆ¶èŠ‚ç‚¹æ—¶è°ƒç”¨ updateï¼šæ‰€åœ¨ç»„ä»¶VNodeæ›´æ–°æ—¶è°ƒç”¨ Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-09-03 15:50:13 "},"interview/vue/4/1.html":{"url":"interview/vue/4/1.html","title":"keep-alive","keywords":"","body":"keep-aliveå¦‚ä½•å®ç°ç»„ä»¶ç¼“å­˜ keep-alive ä»‹ç» keep-alive æ˜¯ vue çš„ä¸€ä¸ªå†…ç½®ç»„ä»¶ï¼Œä¸»è¦æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼Œincludeï¼Œexclude å’Œ maxï¼Œinclude å’Œ exclude å¯ä»¥æ¥æ”¶ Stringï¼ŒRegExpï¼Œ Array ä¸‰ç§ç±»å‹æ•°æ®ï¼Œç”¨ä»¥åŒ¹é…ç»„ä»¶ Nameï¼Œmax è¡¨ç¤ºæœ€å¤šä¿å­˜å®ä¾‹ä¸ªæ•°ï¼Œè‹¥è¶…è¿‡è¿™ä¸ªæ•°å­—ï¼Œå·²ç¼“å­˜ç»„ä»¶ä¸­æœ€ä¹…æ²¡æœ‰è¢«è®¿é—®çš„å®ä¾‹ä¼šè¢«é”€æ¯æ‰ keep-aliveçš„ä½¿ç”¨ Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-10-15 14:29:40 "},"interview/vue/5/1.html":{"url":"interview/vue/5/1.html","title":"next-tick","keywords":"","body":"next-tick next-tickçš„ä½œç”¨ next-tick å°±æ˜¯ä¸¢ä¸€ä¸ªä»»åŠ¡è¿›å»ï¼Œåœ¨ç©ºé—²çš„æ—¶å€™å»æ‰§è¡Œ next-tickçš„è‡ªå®šä¹‰å®ç° let timerFunc; let callbacks = []; function nextTick (cb, ctx) { const callback = () => { cb.call(ctx); } callbacks.push(callback); timerFunc(); } if (typeof Promise !== 'undefined') { const p = Promise.resolve(); timerFunc = () => { p.then(flushCallbacks); } } else if (typeof MutationObserver !== 'undefined') { let count = 1; const mo = new MutationObserver(flushCallbacks); const textNode = document.createTextNode(); mo.observe(textNode, { characterData: true }); timerFunc = () => { count = 1 - count; textNode.data = String(count); } } else if (typeof setImmediate === 'function') { timerFunc = setImmediate(flushCallbacks); } else if (typeof setTimeout === 'function') { timerFunc = setTimeout(flushCallbacks, 0); } function flushCallbacks () { let cbs = callbacks.slice(0); for (let cb of cbs) { cb(); } } Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-10-15 15:33:52 "},"interview/vue/6/1.html":{"url":"interview/vue/6/1.html","title":"vueå¦‚ä½•åšç¼–è¯‘æ—¶ä¼˜åŒ–AOTï¼Ÿ","keywords":"","body":" JIT å³æ—¶ç¼–è¯‘ï¼šjust-in-time compile React çš„æ¨¡ç‰ˆä¸­å…è®¸å†™ js ä»£ç ï¼Œç„¶è€Œ vue çš„æ¨¡ç‰ˆä¸­ä¸å…è®¸å†™ js ä»£ç  React æ˜¯å³æ—¶ç¼–è¯‘ï¼Œä¼šåœ¨æ‰§è¡Œæ—¶æŠŠ jsx ç¼–è¯‘ä¸º js ä»£ç  Vue æ˜¯å³æ—¶ç¼–è¯‘å…¼è¿è¡Œå‰ç¼–è¯‘ï¼Œå°±çœ‹ $options.render æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨ä¸ºè¿è¡Œå‰ç¼–è¯‘ï¼Œåä¹‹å³æ—¶ç¼–è¯‘ AOT è¿è¡Œå‰ç¼–è¯‘ï¼šAhead-of-time compile Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-10-22 16:57:59 "},"interview/vue/7/1.html":{"url":"interview/vue/7/1.html","title":"å¦‚ä½•ç»™Vueå®šä¹‰å…¨å±€æ–¹æ³•","keywords":"","body":" è§£ç­” Vue.prototype Vue.prototype.call = () => console.log('call') mixin æ–¹å¼ const mixin = { methods: { call () { console.log('call') } } } Vue.mixin(mixin) Plugin æ–¹å¼ const plugin = { install (Vue) { Vue.prototype.$call = () => { console.log('call') } } } Vue.use(plugin) Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-11-03 18:30:17 "},"interview/js/":{"url":"interview/js/","title":"js","keywords":"","body":"jsé«˜é¢‘é¢˜ Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-09-02 15:11:57 "},"interview/js/1/1.html":{"url":"interview/js/1/1.html","title":"å†™ä¸€ä¸ªæ·±æ‹·è´ï¼Œè€ƒè™‘ æ­£åˆ™ï¼ŒDateè¿™ç§ç±»å‹çš„æ•°æ®","keywords":"","body":" è§£ç­” æ–¹æ¡ˆä¸€ï¼šJSON.parse(JSON.stringify(source)) ç¼ºç‚¹ï¼š undefined, å‡½æ•°ï¼Œsymbolå€¼ï¼Œåœ¨åºåˆ—åŒ–è¿‡ç¨‹ä¸­ä¼šè¢«å¿½ç•¥ ä¸èƒ½å¤„ç†Bigintç±»å‹çš„æ•°æ®å’Œå¾ªç¯å¼•ç”¨ï¼Œä¼šæŠ¥é”™ Mapï¼ŒSetï¼ŒRegExpç±»å‹çš„æ•°æ®ï¼Œä¼šå¼•ç”¨ä¸¢å¤±ï¼Œå˜æˆç©ºå€¼ Dateç±»å‹çš„æ•°æ®ä¼šè¢«å½“ä½œå­—ç¬¦ä¸²å¤„ç† NaNï¼ŒInfinityï¼Œnulléƒ½ä¼šè¢«å½“ä½œnull Map/Set/WeakMap/WeakSet ä»…ä¼šåºåˆ—åŒ–å¯æšä¸¾çš„æ•°æ® æ–¹æ¡ˆäºŒï¼šåˆ¤æ–­ç±»å‹ä¸ºobject åˆ¤æ–­å‚æ•°ç±»å‹ä¸ºobjectåï¼Œå¤åˆ¶é”®/å€¼åˆ°ç›®æ ‡å¯¹è±¡ï¼Œå¦åˆ™è¿”å›æºå¯¹è±¡ function deepClone (source) { if (typeof source === 'object') { const result = Array.isArray(source) ? [] : {} for (let key in source) { const prop = source[key] if (typeof prop === 'object') { result[key] = deepClone(prop) } else { result[key] = prop } } return result } return source } æ–¹æ¡ˆä¸‰ï¼šReflectä»£ç†æ³• Reflect.ownKeyså¯ä»¥è·å–ä¸å¯æšä¸¾å±æ€§ï¼ŒObject.keysåªèƒ½åˆ—ä¸¾å¯æšä¸¾å±æ€§ function deepClone (obj) { if (typeof obj === 'object') { let cloneObj = Array.isArray(obj) ? [] : {} Reflect.ownKeys(cloneObj).forEach(key => { const prop = obj[key] cloneObj[key] = typeof prop === 'object' ? deepClone(prop) : obj[key] }) return cloneObj } return obj } æ–¹æ¡ˆå››ï¼šç»ˆææ–¹æ¡ˆ æ–¹æ¡ˆäºŒå’Œæ–¹æ¡ˆä¸‰çš„æ€æƒ³éƒ½æ˜¯éå†å±æ€§ï¼Œç„¶åé‡æ–°èµ‹å€¼ï¼Œä½†æ˜¯ä»ç„¶è§£å†³ä¸äº†Mapï¼ŒSetï¼ŒRegExpï¼ŒDateä¹‹ç±»çš„é—®é¢˜æ·±æ‹·è´çš„å‡ ä¸ªç‰¹æ®Šç±»å‹ï¼š Date Map Set RegExp Function Symbol æ—¥æœŸæ‹·è´ let source = new Date() let copy = new date.constructor(source) Mapæ‹·è´ let source = new Map([['name', 'xuqiang'], ['age', 29]]) let copy = new Map() source.forEach((val, key) => { copy.set(key, val) }) Setæ‹·è´ let source = new Set([1, 2, 3, 4, 5]) let copy = new Set() source.forEach(item => { copy.add(item) }) RegExpæ‹·è´ let source = /a/ let copy = new source.constructor(source.source, /\\w*$/.exec(source)) copy.lastIndex = source.lastIndex Symbolæ‹·è´ let source = { [Symbol('name')]: Symbol('xuqiang') } let copy = {} let symbols = Object.getOwnPropertySymbols(source) for (let symbol of symbols) { copy[symbol] = source[symbol] } å‡½æ•°çš„æ‹·è´ å‡½æ•°è½¬å­—ç¬¦ä¸² function func (name, age) { console.log(name, age) } const funcString = func.toString() å­—ç¬¦ä¸²è½¬å‡½æ•° // æ–¹æ¡ˆä¸€: const func = eval(`(${funcString})`) // æ–¹æ¡ˆäºŒï¼š const func = new Function('return ' + funcString)() åŒ¹é…å‚æ•°å’Œå‡½æ•°ä½“ åŒ¹é…å‚æ•° const paramReg = /(?åŒ¹é…å‡½æ•°ä½“ const bodyReg = /(?å‡½æ•°æ‹·è´çš„ä¸¤ç§æ–¹æ³• eval const funcString = func.toString() const funcCopy = eval(`(${funcString})`) new Function ``` const paramReg = /(?(?=)\\s[{|=>])/ const bodyReg = /(? const param = paramReg.exec(funcString) const bodyReg = bodyReg.exec(funcString) if (body) { if (param) { const params = param[0].split(',') new Function (...params, body[0]) } else { new Function (body[0]) } } ``` Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-09-02 20:25:50 "},"interview/js/2/1.html":{"url":"interview/js/2/1.html","title":"æœ‰1000ä¸ªdomï¼Œéœ€è¦æ›´æ–°å…¶ä¸­çš„100ä¸ªï¼Œå¦‚ä½•æ“ä½œæ‰èƒ½å‡å°‘domçš„æ“ä½œï¼Ÿ","keywords":"","body":" è§£ç­” æ€§èƒ½ç“¶é¢ˆï¼š DOMè®¿é—® DOMä¿®æ”¹å¯¼è‡´é‡ç»˜å’Œé‡æ’ ç¼“å­˜DOMå¯¹è±¡ å°†DOMå¯¹è±¡ç¼“å­˜ã€‚é¿å…é‡å¤æŸ¥è¯¢ æ–‡æ¡£ç‰‡æ®µ åœ¨æ–‡æ¡£ç‰‡æ®µä¸Šæ·»åŠ domèŠ‚ç‚¹ï¼Œä¸ä¼šå½±å“åˆ°çœŸæ˜¯çš„domç»“æ„å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹å°†éœ€è¦ä¿®æ”¹çš„domä¸€å¹¶ä¿®æ”¹å®Œï¼Œä¿å­˜è‡³æ–‡æ¡£ç‰‡æ®µä¸­ï¼Œé¿å…é¢‘ç¹ä¿®æ”¹domè€Œå¯¼è‡´çš„é‡æ’è·Ÿé‡ç»˜çš„è¿‡ç¨‹ å¦‚æœè¦å¯¹å…ƒç´ è¿›è¡Œå¤æ‚çš„æ“ä½œï¼ˆåˆ å‡ï¼Œæ·»åŠ å­èŠ‚ç‚¹ï¼‰ï¼Œåº”å°†æ­¤å…ƒç´ å…ˆç§»é™¤æˆ–cloneNodeï¼Œæ“ä½œå®Œæˆä¹‹åå†æ›¿æ¢åŸæ¥èŠ‚ç‚¹ ä½¿ç”¨innerHtmlä»£æ›¿é«˜é¢‘çš„appendChild æœ€ä¼˜çš„layoutæ–¹æ¡ˆ æ‰¹é‡è¯»ï¼Œä¸€æ¬¡æ€§å†™ã€‚æŠŠä»»ä½•å¯¼è‡´é‡ç»˜çš„æ“ä½œæ”¾å…¥requestAnimationFrame è™šæ‹ŸDOM å°†domæŠ½è±¡ä¸ºè™šæ‹Ÿdomï¼Œåœ¨domå˜åŒ–æ—¶å…ˆå¯¹è™šæ‹Ÿdomè¿›è¡Œæ“ä½œï¼Œé€šè¿‡dom diffå°†è™šæ‹Ÿdomå’ŒåŸè™šæ‹Ÿdomåšå¯¹æ¯”ï¼Œæœ€ç»ˆæ‰¹é‡ä¿®æ”¹çœŸå®domç»“æ„ Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-09-11 17:50:35 "},"interview/js/3/1.html":{"url":"interview/js/3/1.html","title":"å…³äºäº‹ä»¶è½®è¯¢ï¼Œå¾®ä»»åŠ¡å®ä»»åŠ¡çš„ä¸€é“é¢˜","keywords":"","body":"å…³äºäº‹ä»¶è½®è¯¢ï¼Œå¾®ä»»åŠ¡å®ä»»åŠ¡çš„ä¸€é“é¢˜ ä»¥ä¸‹è¾“å‡ºæ˜¯ä»€ä¹ˆ console.log('start'); setTimeout(() => { console.log('children2'); // æµ‹è¯•ä¸€ï¼š // Promise.resolve().then(() => { // console.log('children'); // }) // æµ‹è¯•äºŒï¼š new Promise(resolve => { resolve() }).then(() => { console.log('children'); }); }, 0); new Promise(function (resolve, reject) { console.log('children4'); setTimeout(function () { console.log('children5'); resolve('children6') }, 0); }).then(res => { console.log('children7'); setTimeout(() => { console.log(res); }, 0); }); Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-09-25 16:28:49 "},"interview/js/4/1.html":{"url":"interview/js/4/1.html","title":"äº‹ä»¶å¾ªç¯","keywords":"","body":"äº‹ä»¶å¾ªç¯ æ ˆ å‡½æ•°è°ƒç”¨å½¢æˆäº†ä¸€ä¸ªç”±è‹¥å¹²å¸§ç»„æˆçš„æ ˆ æ ˆå­˜å‚¨æ•°æ®çš„ç‰¹ç‚¹ï¼š åŸºæœ¬æ•°æ®ç±»å‹ å † å †è¡¨ç¤ºä¸€å¤§å—å†…å­˜åŒºåŸŸ äº‹ä»¶å¾ªç¯ while (queue.waitForMessage()) { queue.processNextMessage(); } Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-09-27 15:23:01 "},"interview/js/5/1.html":{"url":"interview/js/5/1.html","title":"å®ç°ä¸€ä¸ªcacheRequestï¼Œä¿è¯å‘å‡ºå¤šæ¬¡åŒä¸€ä¸ªajaxè¯·æ±‚æ—¶éƒ½èƒ½æ‹¿åˆ°æ•°æ®ï¼Œè€Œå®é™…ä¸Šåªå‘å‡ºä¸€æ¬¡è¯·æ±‚","keywords":"","body":" function cacheRequest (): (method: string, url: string, param: string | Document | Blob | ArrayBufferView | ArrayBuffer | FormData | URLSearchParams | ReadableStream) => Promise { const cache = {} return (method, url, param) => { const key = `${method}:${url}:${JSON.stringify(param)}` if (cache[key]) { return cache[key]; } return ( cache[key] = new Promise((resolve, reject) => { const xhr = new XMLHttpRequest(); xhr.onreadystatechange = () => { if (xhr.status === 200) { const { response } = xhr cache[url] = response resolve(response) } } xhr.open(method, url, true); xhr.setRequestHeader('Content-Type', 'applicetion/json'); xhr.send(param); }).catch(e => { console.log('error:', e); }) ) } } Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-09-27 16:53:20 "},"interview/js/6/1.html":{"url":"interview/js/6/1.html","title":"çˆ¬æ¥¼æ¢¯ï¼æ¯æ¬¡ä½ å¯ä»¥çˆ¬ 1 æˆ– 2 ä¸ªå°é˜¶ã€‚ä½ æœ‰å¤šå°‘ç§ä¸åŒçš„æ–¹æ³•å¯ä»¥çˆ¬åˆ°æ¥¼é¡¶å‘¢ï¼Ÿ","keywords":"","body":" è§£ç­” æ¯æ¬¡åªèƒ½çˆ¬ 1 å±‚æˆ–è€… 2å±‚å°é˜¶ï¼Œé‚£ä¹ˆåˆ°è¾¾ n å±‚çš„æ–¹æ³•æœ‰ä¸¤ç§ï¼š ä» n-1 èµ° 1 å±‚åˆ° n å±‚ ä» n-2 èµ° 2 å±‚åˆ° n å±‚ é‚£ä¹ˆä»¥æ­¤ç±»æ¨ n ä¸º 3 æ—¶ï¼Œn3 = n2 + n1ï¼šå¯ä»¥çœ‹å‡ºè¿™æ˜¯ä¸ªæ–æ³¢é‚£å¥‘æ•°åˆ— function stairs () { const fibonacii = []; return (stairNum) => { if (fibonacii[stairNum - 1]) { return fibonacii[stairNum - 1]; } let len = fibonacii.length while (len Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-09-29 10:32:35 "},"interview/js/7/1.html":{"url":"interview/js/7/1.html","title":"for_of å’Œ for_in çš„åŒºåˆ«","keywords":"","body":" è§£ç­” for_in æ˜¯ç”¨äºéå†éSymbolç±»å‹çš„å¯æšä¸¾å±æ€§for_of æ˜¯ç”¨äºéå†è¿­ä»£å¯¹è±¡çš„ è¿­ä»£å¯¹è±¡ æ‹¥æœ‰ Symbol.iterator å±æ€§ï¼Œå€¼ä¸ºä¸€ä¸ªå‡½æ•° iterator å‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œæ‹¥æœ‰nextå±æ€§ï¼Œnextå€¼ä¸ºå‡½æ•° next å‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œæœ‰ done å±æ€§å’Œ value å±æ€§ï¼Œdone ä»£è¡¨è¿­ä»£æ˜¯å¦å®Œæˆï¼Œvalue ä»£è¡¨å½“å‰è¿­ä»£å€¼ for_of å¦‚ä½•è¿­ä»£æ™®é€šå¯¹è±¡ Object.keys Object.values Object.entries è‡ªå®šä¹‰ Symbol.iterator Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-10-09 17:21:50 "},"interview/js/8/1.html":{"url":"interview/js/8/1.html","title":"Object.keys å’Œ for_in çš„åŒºåˆ«","keywords":"","body":" è§£ç­” for_in å’Œ Object.keys éå†é¡ºåºä¸€è‡´ï¼Œéå†å¯æšä¸¾å±æ€§ for_in ä¼šéå†åŸå‹é“¾ä¸Šçš„å±æ€§ï¼ŒObject.keys ä¸ä¼š Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-10-09 17:27:09 "},"interview/js/9/1.html":{"url":"interview/js/9/1.html","title":"å‡ ç§æ•°æ®ç±»å‹çš„æ·±æ‹·è´","keywords":"","body":" è§£ç­” RegExp å¯¹è±¡æ‹·è´ const sourceReg = /abc/gi; const copyReg = new RegExp(sourceReg.source, sourceReg.flags) ä» url ä¸­æå–å­åŸŸå const url = 'http://xxx.domain.com'; /http:\\/\\/(\\w+)\\./.exec(url); RegExp.$1 function å‡½æ•°æ‹·è´ function aa (a, b) { console.log(a.toString(), a); console.log(b.toString(), b); } const funcStr = aa.toString(); const funcParaReg = /^function\\s\\w+\\s{0,}\\((.*)\\)/; const funcParaRet = funcStr.match(funcParaReg); const funcPara = funcParaRet[1]; const funcBodyReg = /^function\\s\\w+\\s{0,}\\(.*\\)\\s{0,}{\\n(.*)\\n}$/s; const funcBodyRet = funcStr.match(funcBodyReg); const funcBody = funcBodyRet[1]; const params = [] funcPara && funcPara.split(',').forEach(param => params.push(param.trim())) const b = new Function (...params, funcBody); b(1111, 2222) Map å¯¹è±¡æ‹·è´ const map = new Map(); if (Object.prototype.toString.call(target) === '[object Map]') { for (let [key, value] of target.entries()) { map.set(key, value) } } Set å¯¹è±¡æ‹·è´ const set = new Set(); if (Object.prototype.toString.call(target) === '[object Set]') { for (let item of target.values) { set.add(item) } } Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-10-10 18:02:04 "},"interview/js/10/1.html":{"url":"interview/js/10/1.html","title":"è¾“å…¥ä¸¤ä¸ªæ—¥æœŸï¼Œè¾“å‡ºä¸­é—´çš„å¹´ä»½å’Œæœˆä»½","keywords":"","body":" è§£ç­” function outputDate (startDate, endDate) { const ret = [] const _start = new Date(startDate); const _end = new Date(endDate); function step () { const _month = _start.getMonth() + 1; const _year = _start.getFullYear(); if (_month Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-10-12 16:28:46 "},"interview/js/11/1.html":{"url":"interview/js/11/1.html","title":"åŠ¨æ‰‹å®ç°ä¸€ä¸ªrepeatæ–¹æ³•","keywords":"","body":" è§£ç­” function repeat (func, times, wait) { return function (...args) { function timeout () { if (times > 0) { times--; func.call(this, args); setTimeout(timeout, wait); } } timeout() } } const repeatFunc = repeat(() => console.log(111), 4, 3000); repeatFunc(); Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-10-13 16:27:56 "},"interview/js/12/1.html":{"url":"interview/js/12/1.html","title":"è¾“å…¥ä¸€ä¸ªæ•°å­—ï¼Œæ‰¾åˆ°å¯¹åº”çš„å­—æ¯","keywords":"","body":" è§£ç­” function transfer (num) { const times = num / 26 | 0; const last = num % 26; let bit16Str = last > 0 ? `\\\\u00${last > 16 ? '7' : '6'}${(last % 16 || 16).toString(16)}` : '\\\\u007A'; const lastStr = new Function(`return '${bit16Str}'`)(); return ''.padStart(last ? times : times - 1, 'a') + lastStr; } çŸ¥è¯†ç‚¹ è¿›åˆ¶è½¬æ¢ // åè¿›åˆ¶è½¬åå…­è¿›åˆ¶ (15).toString(16) // åå…­è¿›åˆ¶è½¬åè¿›åˆ¶ Number('oxf') // åè¿›åˆ¶è½¬äºŒè¿›åˆ¶ (15).toString(2) // äºŒè¿›åˆ¶è½¬åè¿›åˆ¶ Number('0b1111') è¿›åˆ¶è¡¨ç¤º äºŒè¿›åˆ¶ï¼š0b å…«è¿›åˆ¶ï¼š0o åå…­è¿›åˆ¶ï¼š0x unicode è¡¨ç¤ºæ³• a-z: \\u0061 - \\u006f \\u0070 - \\u007a // unicode è½¬ string æ–¹æ³•ä¸€ï¼ševal(`'${str}'`) æ–¹æ³•äºŒï¼šnew Function(`return '${str}'`) æ–¹æ³•ä¸‰ï¼šunescape(str.replace(/\\u/g, '%u')) // string è½¬unicode `\\\\u${str.charCodeAt(i).toString(16)}` charCodeAt è¿”å› Unicode ç ç‚¹ï¼Œéœ€è½¬ä¸º16è¿›åˆ¶ Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-10-15 17:26:59 "},"interview/js/13/1.html":{"url":"interview/js/13/1.html","title":"å¦‚ä½•åˆ¤æ–­æµè§ˆå™¨äº‹ä»¶æ˜¯å¦æ”¯æŒæ•è·","keywords":"","body":" è§£ç­” let supportPassive = false; const opts = { get passive () { console.log('browser event support passive'); suportPassive = true; } } window.addEventListener('test-passive', null, opts); Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-10-21 15:18:32 "},"interview/js/14/1.html":{"url":"interview/js/14/1.html","title":"ğŸœ é‡‘æœ å¼‚æ­¥ä¸²è¡Œé¢è¯•é¢˜","keywords":"","body":" è¦æ±‚å®ç° createFlowï¼ŒæŒ‰ç…§ a,b,å»¶è¿Ÿ1ç§’,c,å»¶è¿Ÿ1ç§’,d,e, done çš„é¡ºåºæ‰“å° è§£ç­” const log = console.log; const isFunc = obj => typeof obj === 'function'; function createFlow (flows) { return new Flow(flows); } class Flow { constructor (flows) { this.flows = flows; } async run (callback) { for (let flow of this.flows) { if (flow instanceof Flow) { const _flows = flow.flows; for (let _flow of _flows) { isFunc(_flow) && await _flow(); } } if (isFunc(flow)) { await flow(); } if (Array.isArray(flow)) { for (let _flow of flow) { isFunc(_flow) && await _flow(); } } } isFunc(callback) && callback() } } Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-10-27 15:31:29 "},"interview/js/15/1.html":{"url":"interview/js/15/1.html","title":"dom æ ‘å’Œæ¸²æŸ“æ ‘èŠ‚ç‚¹ä¸€ä¸€å¯¹åº”å—","keywords":"","body":" è§£ç­” æµè§ˆå™¨ä¸€å¸§ç»˜åˆ¶çš„ä¸»è¦æ­¥éª¤ï¼š è¾“å…¥äº‹ä»¶å›è°ƒå¤„ç†ï¼šæ¯”å¦‚æ»šåŠ¨ requestAnimationFrameï¼šä¸Šä¸€å¸§å®šä¹‰çš„requestAnimationFrame Parse HTML ç”Ÿæˆ dom tree Recalc Styles ç”Ÿæˆ css tree Layoutï¼šdom tree å’Œ css tree ç»“åˆç”Ÿæˆ layout tree Update Layer Tree Paintï¼šç»˜åˆ¶ Composite: åˆå¹¶å›¾å±‚ å¾®ä»»åŠ¡è°ƒç”¨ å®ä»»åŠ¡è°ƒç”¨ domæ ‘å’Œæ¸²æŸ“æ ‘çš„èŠ‚ç‚¹å¹¶éä¸€ä¸€å¯¹åº”çš„ css ä¸ºdisplayçš„èŠ‚ç‚¹ï¼Œdomæ ‘æœ‰ï¼Œæ¸²æŸ“æ ‘æ²¡æœ‰ css ä¼ªå…ƒç´ ï¼Œdomæ ‘æ²¡æœ‰ï¼Œæ¸²æŸ“æ ‘æœ‰ requestIdleCallback æ˜¯å¹²ä»€ä¹ˆç”¨çš„ ç”µè„‘å±å¹•ä¸€å¸§çš„æ—¶é—´æ ¹æ®å±å¹•åˆ·æ–°ç‡ç¡®å®š âœ… ï¼šæ¯”å¦‚ä¸€å°ç”µè„‘ä¸º60HZï¼Œæ„æ€å°±æ˜¯1ç§’é’Ÿåˆ·æ–°60æ¬¡ï¼Œé‚£ä¹ˆä¸€å¸§çš„æ—¶é—´å°±æ˜¯ï¼š1000/60 = 16.7msä¸€å¸§çš„ç»˜åˆ¶æ‰§è¡Œåˆ° Composite ï¼Œæœ‰å¯èƒ½è¿˜æ²¡åˆ°16.7msï¼Œæœ‰ç©ºé—²æ—¶é—´ï¼Œé‚£ä¹ˆæœ‰å¤šå°‘ç©ºé—²æ—¶é—´å‘¢ï¼Ÿä½¿ç”¨ requestIdleCallback æŸ¥è¯¢ç©ºé—²æ—¶é—´ window.requestIdleCallback(idleDeadline => { console.log('æ˜¯å¦è¿‡æœŸï¼š', idleDeadline.didTimeout); console.log('å‰©ä½™æ—¶é—´ï¼š', idleDeadline.timeRemaining()) }) å›¾è§£ Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-11-03 19:28:59 "},"interview/react/":{"url":"interview/react/","title":"react","keywords":"","body":"React æ¯æ—¥ä¸€é¢˜ Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-10-09 19:16:37 "},"interview/react/1/1.html":{"url":"interview/react/1/1.html","title":"React Contextçš„ç†è§£","keywords":"","body":" è§£ç­” React Context ä¸»è¦æ˜¯è§£å†³è·¨å±‚çº§ç»„ä»¶æ•°æ®ä¼ é€’ï¼Œå¯ä»¥å½“ä½œæ˜¯ç‰¹å®šä¸€ä¸ªç»„ä»¶æ ‘å†…å…±äº«çš„store è¿‡æ—¶çš„Context class Parent extends PureComponent { getChildContext () { return { color: 'red' } } } Parent.childContextTupes = { color: PropTypes.string } Child.contextTypes = { color: PropTypes.string } æ–°Context const ThemeContext = React.createContext('light'); // Parent class ThemedButton extends PureComponent { static contextType = ThemeContext; render () { this.context } } ä¼˜ç¼ºç‚¹ ä¼˜ç‚¹ï¼šä¸åŒå±‚çº§çš„ç»„ä»¶éœ€è¦è®¿é—®åŒæ ·ä¸€äº›æ•°æ® ç¼ºç‚¹ï¼šç»„ä»¶çš„å¤ç”¨æ€§å˜å·® ç»„ä»¶å¤ç”¨æ˜¯ä¸€ç§æ›´å¥½çš„æ–¹å¼ Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-10-09 19:34:54 "},"interview/react/2/1.html":{"url":"interview/react/2/1.html","title":"React fiberæ˜¯ä»€ä¹ˆï¼Ÿæ€ä¹ˆç”¨","keywords":"","body":" ä¸ºä»€ä¹ˆéœ€è¦ React fiber react v16 ä¹‹å‰æ˜¯é€šè¿‡ æ ‘å½¢ç»“æ„ ä¿å­˜ virtual domï¼Œè¿™ç§ç»“æ„æœ‰ä¸¤ä¸ªé—®é¢˜ï¼š æ›´æ–°ä»»åŠ¡æ˜¯ä¸å¯ä¸­æ­¢çš„ï¼šæ¯”å¦‚å½“å‰æ›´æ–°åˆ°äº†æŸä¸ªèŠ‚ç‚¹ï¼Œå¦‚æœä»»åŠ¡åœæ­¢äº†ï¼Œé‚£ä¹ˆéœ€è¦é‡æ–°è¿›è¡Œæ›´æ–° ä»»åŠ¡æ‰§è¡Œæ—¶é•¿è¿‡é•¿å¯¼è‡´ä¸¢å¸§ï¼šç”±äºæ›´æ–°ä»»åŠ¡æ˜¯ä¸å¯ä¸­æ­¢çš„ï¼Œæ—¶é—´å°±å¾ˆéš¾æŒæ§ï¼Œå½“ä¸€ä¸ª dom tree èŠ‚ç‚¹å¾ˆå¤šæ—¶ï¼Œæ‰§è¡Œæ—¶é—´å°±ä¼šå¾ˆé•¿ï¼Œæ¯”å¦‚ä¸€å¸§çš„æ—¶é—´æ›´é•¿ã€‚å°±å¯èƒ½å¯¼è‡´ä¸¢å¸§ fiber æ˜¯ä»€ä¹ˆ å¯ä»¥ç†è§£ä¸º fiber æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œvirtual dom ä» æ ‘å½¢ç»“æ„ å˜æˆ fiber tree é“¾è¡¨ç»“æ„ å¦‚ä½•å®ç° fiber é“¾æ¥ç»“æ„ æ ‘å½¢ç»“æ„æ˜¯é€šè¿‡ children æ¥å…³è”å„ä¸ªèŠ‚ç‚¹ï¼Œé€šè¿‡æ·±åº¦ä¼˜å…ˆéå†çš„æ–¹å¼è¿›è¡Œ diffé“¾è¡¨ç»“æ„æ˜¯é€šè¿‡ childï¼Œsibling return æ¥å…³è”å„ä¸ªèŠ‚ç‚¹ï¼Œé€šè¿‡æ·±åº¦ä¼˜å…ˆéå†çš„æ–¹å¼ä»¥åŠ firstEffectï¼ŒnextEffectï¼ŒeffectTag çš„é…åˆè¿›è¡Œ diff æ›´æ–° React åŸç”Ÿ fiber è·å–æ¸²æŸ“çš„ fiber root document.getElementById('app')._reactRootContainer._internalRoot; fiber root ç»“æ„ FiberRootNode { - containerInfo: div#app - current: FiberNode - child: - child: - return: FiberRootNode - sibling: null - firstEffect: null - lastEffect: null - nextEffect: null - stateNode: ul.list - return: null - sibling: null - firstEffect: ul - lastEffect: ul - nextEffect: null - stateNode: div#app - hydrat: false } å¦‚ä½•å®ç°ä¸€ä¸ªç®€ç‰ˆ React fiber React fiberæ˜¯ä¸€ä¸ªé“¾è¡¨ç»“æ„ï¼Œæ‰€ä»¥éå†é“¾è¡¨ workLoop function workLoop () { while (nextUnitOfWork) { nextUnitOfWork = performUnitOfWork(nextUnitOfWork) } // æäº¤æ”¾åˆ°æœ€åä¸€èµ·æäº¤ï¼Œé¿å…éƒ¨åˆ†èŠ‚ç‚¹æ¸²æŸ“äº†ï¼Œéƒ¨åˆ†èŠ‚ç‚¹æœªæ¸²æŸ“ commitRoot() } performUnitOfWork ä¸¤ä¸ªä½œç”¨ï¼š å¼€å§‹å½“å‰ workInProgress çš„å·¥ä½œ è¿”å›é“¾è¡¨ä¸‹ä¸€ä¸ªèŠ‚ç‚¹: æœ‰å„¿å­è¿”å›å„¿å­ï¼Œæ²¡å„¿å­è¿”å›å”å”ï¼Œæ²¡å”å”å¾€ä¸Šèµ° å½“ä¸€ä¸ªèŠ‚ç‚¹æ²¡å„¿å­æ—¶ï¼Œæ‰§è¡Œ compeleteUnitOfWork function performUnitOfWork (workInProgress) { beginWork(workInProgress) if (workInProgress.child) { return workInProgress.child } while (workInProgress) { completeUnitOfWork(workInProgress) if (workInProgress.sibling) { return workInProgress.sibling } workInProgress = workInProgress.return } } beginWork ä¸¤ä¸ªä½œç”¨ï¼š åˆ›å»º stateNode ç»´æŠ¤ childï¼Œreturnï¼Œsiblingï¼ŒeffectTag function beginWork (workInProgress) { if (!workInProgress.stateNode) { workInProgress.stateNode = document.createElement(workInProgress.type) } let prevFiber workInProgress.props.children.forEach((child, index) => { if (typeof child === 'string') { const childEl = document.createElement(child) workInProgress.stateNode.appendChild(childEl) } else { child = { ...child, return: workInProgress, child: null, sibling: null, effectTag: 'PLACEMENT', firstEffect: null, lastEffect: null, nextEffect: null } if (index === 0) { workInProgress.child = child } else { prevFiber.sibling = child } prevFiber = child } }) } completeUnitOfWork ç»´æŠ¤firstEffectï¼ŒlastEffect, nextEffect function completeUnitOfWork (workInProgress) { const returnFiber = workInProgress.return if (!returnFiber.firstEffect) { returnFiber.firstEffect = workInProgress.firstEffect } if (workInProgress.lastEffect) { if (returnFiber.lastEffect) { returnEffect.lastEffect.nextEffect = workInProgress.lastEffect } returnEffect.lastEffect = workInProgress.lastEffect } if (workInProgress.effectTag) { if (returnFiber.lastEffect) { returnFiber.lastEffect.nextEffect = workInprogress } else { returnFiber.firstEffect = workInProgress } returnFiber.lastEffect = workInProgress } } commitRoot æ›´æ–°UI function commitRoot () { const nextEffect = workInProgressRoot.firstEffect while (nextEffect) { nextEffect.return.stateNode.appendChild(nextEffect.stateNode) nextEffect = nectEffect.return } } Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-10-29 14:39:49 "},"interview/react/3/1.html":{"url":"interview/react/3/1.html","title":"antd4 rc-field-formå¦‚ä½•å®ç°çš„","keywords":"","body":" å­¦ä¹  rc-field-form çš„å‡ ä¸ªçŸ¥è¯†ç‚¹ å®ç°Formç»„ä»¶çš„æ•°æ®ä¸Šä¸‹æ–‡é«˜é˜¶ç»„ä»¶ å®ç°Formç»„ä»¶ä¸­çš„æ•°æ®æ‰˜ç®¡ å®ç°Formç»„ä»¶ä¸­çš„åŒå‘æ•°æ®ç»‘å®š å®ç°Formç»„ä»¶ä¸­çš„å¼ºåˆ¶æ›´æ–° å®ç°Formç»„ä»¶ä¸­çš„å¼‚æ­¥è¡¨å•æ ¡éªŒ rc-field-form çš„ä½¿ç”¨ import Form, { Field } from 'rc-field-form' const validateUniqueName = (name, value) => { return new Promise(resolve => { setTimeout(() => { resolve(value === 'xiur' ? `${name} is not unique` : '') }, 3000) }) } { console.log('æˆåŠŸï¼š', values) }} onFinishFailed={(error) => { console.log('å¤±è´¥ï¼š', error) }} > å®ç°é€»è¾‘ Form ç»„ä»¶ å®ä¾‹åŒ– formInstance åˆå§‹åŒ– store è®¾ç½® callbacks ä½¿ç”¨ context Field ç»„ä»¶ è·å– context å…‹éš† children é‡å†™ props æ³¨å†Œ Field å£°æ˜ onStateChangeï¼Œstore æ”¹å˜ forceUpdate useForm useForm è¿”å› formInstance FormStore æ•°æ®æ‰˜ç®¡ async-validate æ•°æ®æ ¡éªŒ Form å®ç° å¦‚ä½•å®ç°åˆå§‹å€¼åªè®¾ç½®ä¸€æ¬¡ï¼Ÿåœºæ™¯ï¼šæ¯”å¦‚å¤–éƒ¨çš„çˆ¶ç»„ä»¶æ›´æ–°ï¼Œä¼šé€ æˆ Form ç»„ä»¶çš„æ›´æ–°ï¼Œæ­¤æ—¶ä¼šé‡æ–°è®¾ç½® initialValueï¼Œå¯æ˜¯æ­¤æ—¶å·²ç»ä¸æ˜¯åˆå§‹åŒ–äº†ä½¿ç”¨ React.useRef å•ä¾‹è§£å†³è¿™ä¸ªé—®é¢˜ const FieldContext = React.createContext() const Form = ({ initialValues, onFinish, onFinishFailed, children }) => { const [ formInstance ] = useForm() const mountRef = React.useRef(null) if(!mountRef.current) { formInstance.setInitialValues(initialValues) formInstance.setCallbacks({ onFinish, onFinishFailed }) mountRef.current = true } return {children} } useForm å®ç° class FormStore { constructor (forceRootUpdate) { this.forceRootUpdate = forceRootUpdate this.store = {} this.callbacks = {} this.fieldEntities = [] } setCallbacks = callbacks => { this.callbacks = {...callbacks} } setInitialValues = store => { this.store = {...store} } setFieldValue = (name, value) => { this.store[name] = value this.notify() } getFieldValue = name => { return this.store[name] } registerField = (fieldEntity) => { this.fieldEntities.push(fieldEntity) } notify = () => { for (let fieldEntity of this.fieldEntities) { fieldEntity.onStateChange() } } submit = () => { const descriptor = {} this.fieldEntities.forEach(fieldEntity => { const { name, rules } = fieldEntity.props if (rules) { const ruleInfo = {} rules.forEach(rule => { const ruleKeys = Object.keys(rule) ruleKeys.forEach(ruleKey => { ruleInfo[ruleKey] = rule[ruleKey] }) }) descriptor[name] = ruleInfo } }) new Schema(descriptor).validate(this.store) .then(values => { this.callbacks.onFinish(values) }) .catch(error => { this.callbacks.onFinishFailed(error) }) } getForm = () => { return { setInitialValues: this.setInitialValues, setCallbacks: this.setCallbacks, setFieldValue: this.setFieldValue, getFieldValue: this.getFieldValue, registerField: this.registerField, submit: this.submit, } } } function useForm () { const formRef = React.useRef(null) const [, forceUpdate] = React.useState() if (!formRef.current) { const formStore = new FormStore(forceUpdate) const formInstance = formStore.getForm() formRef.current = formInstance } return [formRef.current] } async-validate å®ç° class Schema { constructor (descriptor) { this.descriptor = descriptor } validate () { return new Promise(async (resolve, reject) => { let errorInfo = [] const fieldNames = Object.keys(this.descriptor) for (let i = 0; i filedRules[fieldRuleName]) { errors.push(`${fieldName} æœ€å¤§ä¸º${filedRules[fieldRuleName]}ä½å­—ç¬¦`) } break case 'validate': const validateFn = filedRules[fieldRuleName] const result = await validateFn(fieldName, values[fieldName]) if (result.length > 0) { errors.push(result) } } } errors.length > 0 ? errorInfo.push({ name: fieldName, errors }) : void(0) } errorInfo.length > 0 ? reject({ errorInfo, values }) : resolve(values) }) } } Field å®ç° è¿™é‡Œä¸»è¦å®ç° åŒå‘æ•°æ®ç»‘å®š å’Œ å¼ºåˆ¶åˆ·æ–° input çš„ value çš„è·å– ä» this.context é€šè¿‡ getFiledValue è·å– å½“ onChange è§¦å‘é€šè¿‡ setFieldValue æ”¹å˜ store æ—¶ï¼Œéœ€è¦æ›´æ–°UIï¼Œå°±é€šè¿‡ store çš„ notify è°ƒç”¨å„ä¸ª Field çš„ onStateChange å®ç° class Field extends React.Component { static contextType = FieldContext componentDidMount () { const formInstance = this.context formInstance.registerField(this) } onStateChange = () => { this.forceUpdate } getControlled = () => { const formInstance = this.context const { name, children } = this.props return React.cloneElement(children, { ...children.props, value: formInstance.getFieldValue(name), onChange: (e) => { formInstance.setFieldValue(name, e.target.value) } }) } render () { return this.getControlled() } } Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-11-04 15:16:15 "},"interview/js/16/1.html":{"url":"interview/js/16/1.html","title":"è¯·åŠ¨æ‰‹å®ç°ä¸€ä¸ª JSON.parse","keywords":"","body":" è§£ç­” æ€»å…±ä¸¤ç§æ–¹æ¡ˆï¼ševalï¼ŒFunction eval function parse (jsonStr) { return eval(`(${jsonStr})`) } new Function function parse (jsonStr) { return new Function(`return ${jsonStr}`)() } Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-11-04 15:53:57 "},"interview/vue/8/1.html":{"url":"interview/vue/8/1.html","title":"å“åº”å¼ä¸cteatedï¼Œ$mountï¼Œmounted","keywords":"","body":" ä»¥ä¸Šä»£ç æ¨¡ç‰ˆä¸­æ¸²æŸ“çš„æ˜¯ä»€ä¹ˆå€¼ï¼Ÿ è§£ç­” æ¨¡ç‰ˆä¸­æ˜¾ç¤ºä¸º1 vueå®ä¾‹åŒ–çš„é¡ºåºæ˜¯ï¼š initStateï¼šobserve(options.data) callHook(vm, 'created') vm.$mount callHook(vm, 'mounted') åŸå› ï¼š æœ€å…ˆæ‰§è¡Œobserveï¼Œæ‰€ä»¥åœ¨ created å’Œ mounted æ·»åŠ çš„å±æ€§ï¼Œéƒ½ä¸æ˜¯å“åº”å¼å±æ€§ created åœ¨ $mount ä¹‹å‰æ‰§è¡Œï¼Œ$mount æŒ‚è½½æ—¶å€¼å·²ç»æ˜¯1ï¼Œæ‰€ä»¥æ¸²æŸ“æ—¶ä¸º1 mounted æ—¶æŠŠ b æ”¹ä¸ºäº†2ï¼Œå¯æ˜¯å±æ€§æ²¡æœ‰è¢« observeï¼Œä¸”å¹¶æ²¡æœ‰é‡æ–°æ¸²æŸ“ï¼Œæ‰€ä»¥è¿˜æ˜¯1 Copyright Â© qiangxu@clubfactory.com 2020 all right reservedï¼Œpowered by Gitbookè¯¥æ–‡ç« ä¿®è®¢æ—¶é—´ï¼š 2020-11-04 16:12:47 "}}